import datetime

data_hosts = {
    "version": "2.3.1 beta",
    "date": datetime.datetime(2023, 10, 21, 11, 48, 55),
    "modules": [
        "three_shake",
        "beast",
        "breach",
        "ccs_injection",
        "certificate_transparency",
        "crime",
        "drown",
        "freak",
        "heartbleed",
        "hsts_preloading",
        "hsts_set",
        "https_enforced",
        "logjam",
        "lucky13",
        "mitzvah",
        "nomore",
        "pfs",
        "poodle",
        "renegotiation",
        "robot",
        "sloth",
        "sweet32",
        "ticketbleed",
    ],
    "hosts": ["www.fbk.eu"],
    "results": {
        "www.fbk.eu": {
            "hsts_preloading": {
                "Name": "HSTS not preloaded",
                "ExtendedName": "HSTS not preloaded",
                "Description": "If the HSTS header is not preloaded, a client may be tricked into visiting the unsecure (HTTP) version of a website. This would allow an attacker to read and manipulate his messages.",
                "Mitigation": {
                    "Textual": "Submit the request to <a href='https://hstspreload.org'>HSTSPreload.org</a>.",
                    "Apache": "No snippet available",
                    "Nginx": "No snippet available",
                },
                "raw": "{ 'HSTS_NOT_PRELOADED': { 'mitigation': { '#omit-xml-declaration': 'yes',\n                                          'Entry': { 'Description': 'If the '\n                                                                    'HSTS '\n                                                                    'header is '\n                                                                    'not '\n                                                                    'preloaded, '\n                                                                    'a client '\n                                                                    'may be '\n                                                                    'tricked '\n                                                                    'into '\n                                                                    'visiting '\n                                                                    'the '\n                                                                    'unsecure '\n                                                                    '(HTTP) '\n                                                                    'version '\n                                                                    'of a '\n                                                                    'website. '\n                                                                    'This '\n                                                                    'would '\n                                                                    'allow an '\n                                                                    'attacker '\n                                                                    'to read '\n                                                                    'and '\n                                                                    'manipulate '\n                                                                    'his '\n                                                                    'messages.',\n                                                     'ExtendedName': 'HSTS not '\n                                                                     'preloaded',\n                                                     'Mitigation': { 'Apache': 'No '\n                                                                               'snippet '\n                                                                               'available',\n                                                                     'Nginx': 'No '\n                                                                              'snippet '\n                                                                              'available',\n                                                                     'Textual': 'Submit '\n                                                                                'the '\n                                                                                'request '\n                                                                                'to '\n                                                                                '<a '\n                                                                                \"href='https://hstspreload.org'>HSTSPreload.org</a>.\"},\n                                                     'Name': 'HSTS not '\n                                                             'preloaded'}},\n                          'www.fbk.eu': True}}",
            },
            "hsts_set": {
                "Name": "HSTS not set",
                "ExtendedName": "HSTS not set",
                "Description": "Without the HSTS header, an attacker can use the SSL stripping attack to redirect all the HTTPS connection to their unsecure counterparts. By doing this, all the messages are sent in plaintext and can thus be manipulated.",
                "Mitigation": {
                    "Textual": "Enable the HSTS header transmission within the webserver's settings.",
                    "Apache": '1. open your Apache configuration file (default: <i>/etc/apache2/sites-available/default-ssl.conf</i>);<br/>2. add the line <code>Header always set Strict-Transport-Security "max-age=31536000"</code>.<br/><br/>N.B. restart the server by typing: <code>sudo service apache2 restart</code> and be sure that <code>mod_headers</code> is enabled.',
                    "Nginx": '1. In a default situation, you can edit your website configuration <i>/etc/nginx/sites-enabled/default</i><br/> (if you changed your site conf name <i>/etc/nginx/sites-enabled/YOURSITECONFIGURATION</i>);<br/>2. Add inside <code>server{...}</code> brackets: <code>add_header Strict-Transport-Security "max-age=31536000; includeSubdomains; preload";</code><br/><br/>N.B. restart the server by typing: <code>sudo service nginx restart</code>.',
                },
                "raw": "{ 'HSTS_NOT_SET': { 'mitigation': { '#omit-xml-declaration': 'yes',\n                                    'Entry': { 'Description': 'Without the '\n                                                              'HSTS header, an '\n                                                              'attacker can '\n                                                              'use the SSL '\n                                                              'stripping '\n                                                              'attack to '\n                                                              'redirect all '\n                                                              'the HTTPS '\n                                                              'connection to '\n                                                              'their unsecure '\n                                                              'counterparts. '\n                                                              'By doing this, '\n                                                              'all the '\n                                                              'messages are '\n                                                              'sent in '\n                                                              'plaintext and '\n                                                              'can thus be '\n                                                              'manipulated.',\n                                               'ExtendedName': 'HSTS not set',\n                                               'Mitigation': { 'Apache': '1. '\n                                                                         'open '\n                                                                         'your '\n                                                                         'Apache '\n                                                                         'configuration '\n                                                                         'file '\n                                                                         '(default: '\n                                                                         '<i>/etc/apache2/sites-available/default-ssl.conf</i>);<br/>2. '\n                                                                         'add '\n                                                                         'the '\n                                                                         'line '\n                                                                         '<code>Header '\n                                                                         'always '\n                                                                         'set '\n                                                                         'Strict-Transport-Security '\n                                                                         '\"max-age=31536000\"</code>.<br/><br/>N.B. '\n                                                                         'restart '\n                                                                         'the '\n                                                                         'server '\n                                                                         'by '\n                                                                         'typing: '\n                                                                         '<code>sudo '\n                                                                         'service '\n                                                                         'apache2 '\n                                                                         'restart</code> '\n                                                                         'and '\n                                                                         'be '\n                                                                         'sure '\n                                                                         'that '\n                                                                         '<code>mod_headers</code> '\n                                                                         'is '\n                                                                         'enabled.',\n                                                               'Nginx': '1. In '\n                                                                        'a '\n                                                                        'default '\n                                                                        'situation, '\n                                                                        'you '\n                                                                        'can '\n                                                                        'edit '\n                                                                        'your '\n                                                                        'website '\n                                                                        'configuration '\n                                                                        '<i>/etc/nginx/sites-enabled/default</i><br/> '\n                                                                        '(if '\n                                                                        'you '\n                                                                        'changed '\n                                                                        'your '\n                                                                        'site '\n                                                                        'conf '\n                                                                        'name '\n                                                                        '<i>/etc/nginx/sites-enabled/YOURSITECONFIGURATION</i>);<br/>2. '\n                                                                        'Add '\n                                                                        'inside '\n                                                                        '<code>server{...}</code> '\n                                                                        'brackets: '\n                                                                        '<code>add_header '\n                                                                        'Strict-Transport-Security '\n                                                                        '\"max-age=31536000; '\n                                                                        'includeSubdomains; '\n                                                                        'preload\";</code><br/><br/>N.B. '\n                                                                        'restart '\n                                                                        'the '\n                                                                        'server '\n                                                                        'by '\n                                                                        'typing: '\n                                                                        '<code>sudo '\n                                                                        'service '\n                                                                        'nginx '\n                                                                        'restart</code>.',\n                                                               'Textual': 'Enable '\n                                                                          'the '\n                                                                          'HSTS '\n                                                                          'header '\n                                                                          'transmission '\n                                                                          'within '\n                                                                          'the '\n                                                                          \"webserver's \"\n                                                                          'settings.'},\n                                               'Name': 'HSTS not set'}},\n                    'www.fbk.eu': True}}",
            },
            "lucky13": {
                "Name": "Lucky 13",
                "ExtendedName": "Lucky 13",
                "CVE": "2013-0169",
                "CVSS2": "2.6 (Low)",
                "#comment": " AV:N/AC:H/Au:N/C:P/I:N/A:N ",
                "Description": "By exploiting the structure of the Cipher Block Chaining (CBC) mode, an attacker can infer the content of a transmission. The attack is performed by capturing, tampering (actually damaging) and re-transmitting the messages sent by the client to see how the server responds.<br/>The attack, by breaching in the authentication mechanism, has a serious impact on the transmission.",
                "Mitigation": {
                    "Textual": "Update the TLS library to a version that contains the custom mitigations (e.g. OpenSSL v1.0.2h+).",
                    "Apache": "No snippet available",
                    "Nginx": "The best mitigation is to update the OpenSSL libraries. The fastest mitigation is to disable all CBC ciphers.<br/><br/>1. In a default situation, you can edit your website configuration <i>/etc/nginx/sites-enabled/default</i><br/> (if you changed your site conf name <i>/etc/nginx/sites-enabled/YOURSITECONFIGURATION</i>);<br/>2. Inside <code>server {...}</code> brackets configuration, find <code>ssl_ciphers</code>;<br/>3. Remove any CBC-related cipher (even nested one).<br/><br/>N.B. restart the server by typing: <code>sudo service nginx restart</code>.<br/>",
                },
                "raw": "{ 'cve': 'CVE-2013-0169',\n  'cwe': 'CWE-310',\n  'finding': 'potentially vulnerable, uses TLS CBC ciphers',\n  'ip': ['141.193.213.20'],\n  'key': ['LUCKY13'],\n  'port': '443',\n  'severity': 'LOW'}",
            },
        }
    },
}

data_module = {
    "version": "2.3.1 beta",
    "date": datetime.datetime(2023, 11, 8, 18, 1, 36),
    "modules": [
        "three_shake",
        "beast",
        "breach",
        "ccs_injection",
        "certificate_transparency",
        "crime",
        "drown",
        "freak",
        "heartbleed",
        "hsts_preloading",
        "hsts_set",
        "https_enforced",
        "logjam",
        "lucky13",
        "mitzvah",
        "nomore",
        "pfs",
        "poodle",
        "renegotiation",
        "robot",
        "sloth",
        "sweet32",
        "ticketbleed",
    ],
    "hosts": ["www.fbk.eu"],
    "results": {
        "hsts_preloading": {
            "Name": "HSTS not preloaded",
            "ExtendedName": "HSTS not preloaded",
            "Description": "If the HSTS header is not preloaded, a client may be tricked into visiting the unsecure (HTTP) version of a website. This would allow an attacker to read and manipulate his messages.",
            "Mitigation": {
                "Textual": "Submit the request to <a href='https://hstspreload.org'>HSTSPreload.org</a>.",
                "Apache": "No snippet available",
                "Nginx": "No snippet available",
            },
            "raw": "{ 'www.fbk.eu': { 'HSTS_NOT_PRELOADED': { 'mitigation': { '#omit-xml-declaration': 'yes',\n                                                          'Entry': { 'Description': 'If '\n                                                                                    'the '\n                                                                                    'HSTS '\n                                                                                    'header '\n                                                                                    'is '\n                                                                                    'not '\n                                                                                    'preloaded, '\n                                                                                    'a '\n                                                                                    'client '\n                                                                                    'may '\n                                                                                    'be '\n                                                                                    'tricked '\n                                                                                    'into '\n                                                                                    'visiting '\n                                                                                    'the '\n                                                                                    'unsecure '\n                                                                                    '(HTTP) '\n                                                                                    'version '\n                                                                                    'of '\n                                                                                    'a '\n                                                                                    'website. '\n                                                                                    'This '\n                                                                                    'would '\n                                                                                    'allow '\n                                                                                    'an '\n                                                                                    'attacker '\n                                                                                    'to '\n                                                                                    'read '\n                                                                                    'and '\n                                                                                    'manipulate '\n                                                                                    'his '\n                                                                                    'messages.',\n                                                                     'ExtendedName': 'HSTS '\n                                                                                     'not '\n                                                                                     'preloaded',\n                                                                     'Mitigation': { 'Apache': 'No '\n                                                                                               'snippet '\n                                                                                               'available',\n                                                                                     'Nginx': 'No '\n                                                                                              'snippet '\n                                                                                              'available',\n                                                                                     'Textual': 'Submit '\n                                                                                                'the '\n                                                                                                'request '\n                                                                                                'to '\n                                                                                                '<a '\n                                                                                                \"href='https://hstspreload.org'>HSTSPreload.org</a>.\"},\n                                                                     'Name': 'HSTS '\n                                                                             'not '\n                                                                             'preloaded'}},\n                                          'www.fbk.eu': True}}}",
            "hosts": ["www.fbk.eu"],
        },
        "hsts_set": {
            "Name": "HSTS not set",
            "ExtendedName": "HSTS not set",
            "Description": "Without the HSTS header, an attacker can use the SSL stripping attack to redirect all the HTTPS connection to their unsecure counterparts. By doing this, all the messages are sent in plaintext and can thus be manipulated.",
            "Mitigation": {
                "Textual": "Enable the HSTS header transmission within the webserver's settings.",
                "Apache": '1. open your Apache configuration file (default: <i>/etc/apache2/sites-available/default-ssl.conf</i>);<br/>2. add the line <code>Header always set Strict-Transport-Security "max-age=31536000"</code>.<br/><br/>N.B. restart the server by typing: <code>sudo service apache2 restart</code> and be sure that <code>mod_headers</code> is enabled.',
                "Nginx": '1. In a default situation, you can edit your website configuration <i>/etc/nginx/sites-enabled/default</i><br/> (if you changed your site conf name <i>/etc/nginx/sites-enabled/YOURSITECONFIGURATION</i>);<br/>2. Add inside <code>server{...}</code> brackets: <code>add_header Strict-Transport-Security "max-age=31536000; includeSubdomains; preload";</code><br/><br/>N.B. restart the server by typing: <code>sudo service nginx restart</code>.',
            },
            "raw": "{ 'www.fbk.eu': { 'HSTS_NOT_SET': { 'mitigation': { '#omit-xml-declaration': 'yes',\n                                                    'Entry': { 'Description': 'Without '\n                                                                              'the '\n                                                                              'HSTS '\n                                                                              'header, '\n                                                                              'an '\n                                                                              'attacker '\n                                                                              'can '\n                                                                              'use '\n                                                                              'the '\n                                                                              'SSL '\n                                                                              'stripping '\n                                                                              'attack '\n                                                                              'to '\n                                                                              'redirect '\n                                                                              'all '\n                                                                              'the '\n                                                                              'HTTPS '\n                                                                              'connection '\n                                                                              'to '\n                                                                              'their '\n                                                                              'unsecure '\n                                                                              'counterparts. '\n                                                                              'By '\n                                                                              'doing '\n                                                                              'this, '\n                                                                              'all '\n                                                                              'the '\n                                                                              'messages '\n                                                                              'are '\n                                                                              'sent '\n                                                                              'in '\n                                                                              'plaintext '\n                                                                              'and '\n                                                                              'can '\n                                                                              'thus '\n                                                                              'be '\n                                                                              'manipulated.',\n                                                               'ExtendedName': 'HSTS '\n                                                                               'not '\n                                                                               'set',\n                                                               'Mitigation': { 'Apache': '1. '\n                                                                                         'open '\n                                                                                         'your '\n                                                                                         'Apache '\n                                                                                         'configuration '\n                                                                                         'file '\n                                                                                         '(default: '\n                                                                                         '<i>/etc/apache2/sites-available/default-ssl.conf</i>);<br/>2. '\n                                                                                         'add '\n                                                                                         'the '\n                                                                                         'line '\n                                                                                         '<code>Header '\n                                                                                         'always '\n                                                                                         'set '\n                                                                                         'Strict-Transport-Security '\n                                                                                         '\"max-age=31536000\"</code>.<br/><br/>N.B. '\n                                                                                         'restart '\n                                                                                         'the '\n                                                                                         'server '\n                                                                                         'by '\n                                                                                         'typing: '\n                                                                                         '<code>sudo '\n                                                                                         'service '\n                                                                                         'apache2 '\n                                                                                         'restart</code> '\n                                                                                         'and '\n                                                                                         'be '\n                                                                                         'sure '\n                                                                                         'that '\n                                                                                         '<code>mod_headers</code> '\n                                                                                         'is '\n                                                                                         'enabled.',\n                                                                               'Nginx': '1. '\n                                                                                        'In '\n                                                                                        'a '\n                                                                                        'default '\n                                                                                        'situation, '\n                                                                                        'you '\n                                                                                        'can '\n                                                                                        'edit '\n                                                                                        'your '\n                                                                                        'website '\n                                                                                        'configuration '\n                                                                                        '<i>/etc/nginx/sites-enabled/default</i><br/> '\n                                                                                        '(if '\n                                                                                        'you '\n                                                                                        'changed '\n                                                                                        'your '\n                                                                                        'site '\n                                                                                        'conf '\n                                                                                        'name '\n                                                                                        '<i>/etc/nginx/sites-enabled/YOURSITECONFIGURATION</i>);<br/>2. '\n                                                                                        'Add '\n                                                                                        'inside '\n                                                                                        '<code>server{...}</code> '\n                                                                                        'brackets: '\n                                                                                        '<code>add_header '\n                                                                                        'Strict-Transport-Security '\n                                                                                        '\"max-age=31536000; '\n                                                                                        'includeSubdomains; '\n                                                                                        'preload\";</code><br/><br/>N.B. '\n                                                                                        'restart '\n                                                                                        'the '\n                                                                                        'server '\n                                                                                        'by '\n                                                                                        'typing: '\n                                                                                        '<code>sudo '\n                                                                                        'service '\n                                                                                        'nginx '\n                                                                                        'restart</code>.',\n                                                                               'Textual': 'Enable '\n                                                                                          'the '\n                                                                                          'HSTS '\n                                                                                          'header '\n                                                                                          'transmission '\n                                                                                          'within '\n                                                                                          'the '\n                                                                                          \"webserver's \"\n                                                                                          'settings.'},\n                                                               'Name': 'HSTS '\n                                                                       'not '\n                                                                       'set'}},\n                                    'www.fbk.eu': True}}}",
            "hosts": ["www.fbk.eu"],
        },
        "lucky13": {
            "Name": "Lucky 13",
            "ExtendedName": "Lucky 13",
            "CVE": "2013-0169",
            "CVSS2": "2.6 (Low)",
            "#comment": " AV:N/AC:H/Au:N/C:P/I:N/A:N ",
            "Description": "By exploiting the structure of the Cipher Block Chaining (CBC) mode, an attacker can infer the content of a transmission. The attack is performed by capturing, tampering (actually damaging) and re-transmitting the messages sent by the client to see how the server responds.<br/>The attack, by breaching in the authentication mechanism, has a serious impact on the transmission.",
            "Mitigation": {
                "Textual": "Update the TLS library to a version that contains the custom mitigations (e.g. OpenSSL v1.0.2h+).",
                "Apache": "No snippet available",
                "Nginx": "The best mitigation is to update the OpenSSL libraries. The fastest mitigation is to disable all CBC ciphers.<br/><br/>1. In a default situation, you can edit your website configuration <i>/etc/nginx/sites-enabled/default</i><br/> (if you changed your site conf name <i>/etc/nginx/sites-enabled/YOURSITECONFIGURATION</i>);<br/>2. Inside <code>server {...}</code> brackets configuration, find <code>ssl_ciphers</code>;<br/>3. Remove any CBC-related cipher (even nested one).<br/><br/><br/>N.B. restart the server by typing: <code>sudo service nginx restart</code>.<br/>",
            },
            "raw": "{ 'www.fbk.eu': { 'cve': 'CVE-2013-0169',\n                  'cwe': 'CWE-310',\n                  'finding': 'potentially vulnerable, uses TLS CBC ciphers',\n                  'ip': ['141.193.213.21'],\n                  'key': ['LUCKY13'],\n                  'port': '443',\n                  'severity': 'LOW'}}",
            "hosts": ["www.fbk.eu"],
        },
    },
}
